#include <stdio.h>
#include <math.h>
#define PI 3.141592653589793
void swap(double *a, double *b) {
    double temp = *a;
    *a = *b;
    *b = temp;
}
void bit_reverse(double real[], double imag[], int N) {
    int i, j, k;
    j = 0;
    for (i = 0; i < N; i++) {
        if (i < j) {
            swap(&real[i], &real[j]);
            swap(&imag[i], &imag[j]);
        }
        k = N / 2;
        while (k <= j) {
            j -= k;
            k /= 2;
        }
        j += k;
    }
}
void FFT_DIT(double real[], double imag[], int N) {
    bit_reverse(real, imag, N); 
    for (int step = 2; step <= N; step <<= 1) {
        int half = step / 2;
        double theta = -2 * PI / step;
        double w_real = cos(theta);
        double w_imag = sin(theta);
        for (int i = 0; i < N; i += step) {
            double u_real = 1.0, u_imag = 0.0;
            for (int j = 0; j < half; j++) {
                int i1 = i + j;
                int i2 = i + j + half;
                double t_real = u_real * real[i2] - u_imag * imag[i2];
                double t_imag = u_real * imag[i2] + u_imag * real[i2];
                real[i2] = real[i1] - t_real;
                imag[i2] = imag[i1] - t_imag;
                real[i1] += t_real;
                imag[i1] += t_imag;
                double temp = u_real;
                u_real = u_real * w_real - u_imag * w_imag;
                u_imag = temp * w_imag + u_imag * w_real;
            }
        }
    }
}
int main() {
    int N = 8;
    double real[8] = {1,-1,-1,0.707,0,-0.707,-1,-0.707};
    double imag[8] = {0,0,0,0,0,0,0,0};
    FFT_DIT(real, imag, N);
    printf("=== DIT FFT Output ===\n");
    for (int i = 0; i < N; i++) {
        printf("X[%d] = %.4f + j%.4f\n", i, real[i], imag[i]);
    }
    return 0;
}
